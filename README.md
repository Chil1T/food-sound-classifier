# 基于音频特征的食物咀嚼声分类系统

这是一个用于复试的极简陋机器学习项目，通过分析食物咀嚼声的声学特征来识别不同类型的食物。该系统利用先进的音频处理技术和机器学习算法，实现了对食物咀嚼声的自动分类。

## 技术亮点

### 1. 音频处理技术
- **自适应分段**：将长音频自动分割为2秒的短片段，确保特征提取的一致性
- **响度归一化**：使用RMS（均方根）归一化处理，提高不同录音条件下的鲁棒性
- **智能静音过滤**：基于相对能量阈值自动过滤无效片段

### 2. 特征工程
- **多维特征提取**：
  - 13维MFCC（梅尔频率倒谱系数）特征
  - MFCC的统计特征（均值、标准差）
  - 频谱质心（Spectral Centroid）
  - 过零率（Zero Crossing Rate）
  - 频谱滚降（Spectral Rolloff）
  - 频谱带宽（Spectral Bandwidth）

### 3. 机器学习模型
- 使用SVM（支持向量机）分类器
- 自动特征缩放和标准化
- 模型持久化存储与加载

## 项目结构

```
project/
│
├── audio/                    # 训练音频文件目录
├── audiofortest/            # 测试音频文件目录
├── spectrograms/            # 频谱图输出目录
│
├── audio_spectrogram.py     # 频谱图生成模块
├── food_classifier.py       # 主分类器模块
├── requirements.txt         # 项目依赖
├── model.joblib            # 保存的模型文件
└── scaler.joblib          # 保存的特征缩放器
```

## 安装说明

### 1. 环境要求
- Python 3.7 或更高版本
- Windows/Linux/MacOS

### 2. 安装步骤

```bash
# 1. 克隆项目
git clone [项目地址]

# 2. 创建虚拟环境（推荐）
python -m venv venv
source venv/bin/activate  # Linux/MacOS
venv\Scripts\activate     # Windows

# 3. 安装依赖
pip install -r requirements.txt

# 4. 安装额外依赖（针对音频格式转换）
# Windows用户：
# 确保已安装ffmpeg并添加到系统PATH
```

### 3. 特殊说明
- 对于Windows用户，需要安装ffmpeg用于音频格式转换：
  1. 下载ffmpeg: https://ffmpeg.org/download.html
  2. 将ffmpeg添加到系统PATH
  3. 验证安装：在命令行运行 `ffmpeg -version`

## 使用方法

### 1. 准备数据
```bash
# 创建必要的目录
mkdir audio audiofortest

# 将训练音频文件放入audio目录
# 将测试音频文件放入audiofortest目录
```

### 2. 训练模型
```bash
py -3.11 food_classifier.py
```

### 3. 预测新样本
```bash
py -3.11 food_classifier.py audiofortest/test_audio.m4a
```

### 4. 生成频谱图（可选）
```bash
py -3.11 audio_spectrogram.py
```

## 预测示例

以下是使用新录制的白菜咀嚼音频进行预测的实际案例：

```
分析音频文件: audiofortest\baicai_fortest.m4a
转换音频格式: .m4a -> .wav
  音频信息:
    - 采样率: 22050 Hz
    - 时长: 11.56 秒
    - RMS响度: 0.005644
  分割音频片段:
    片段 1: RMS = 0.108271, 阈值 = 0.010000, 通过
    片段 2: RMS = 0.104755, 阈值 = 0.010000, 通过
    片段 3: RMS = 0.096639, 阈值 = 0.010000, 通过
    片段 4: RMS = 0.100935, 阈值 = 0.010000, 通过
    片段 5: RMS = 0.124825, 阈值 = 0.010000, 通过

预测结果:
- 白菜: 4个片段 (80.0%)
- 鸡皮: 1个片段 (20.0%)
```

### 结果解析
1. **音频预处理**：
   - 系统自动将 m4a 格式转换为 wav 格式
   - 原始音频长度为 11.56 秒
   - 采样率为 22050 Hz（标准音频采样率）

2. **分段处理**：
   - 音频被分割成5个有效片段
   - 每个片段的RMS值都高于阈值（0.01），表示都是有效的咀嚼声音
   - RMS值范围在0.096-0.124之间，显示响度相对稳定

3. **预测结果**：
   - 80%的片段（4个）被识别为白菜
   - 20%的片段（1个）被误识别为鸡皮
   - 主导预测结果为白菜，与实际相符

4. **可靠性分析**：
   - 高比例（80%）的一致预测表明结果可信
   - 少量误判（20%）反映了模型在某些特征上的重叠

## 实验结果

当前模型在测试集上的表现：
- 整体准确率：64%
- 各类别F1分数：
  - 白菜：0.67
  - 豆皮：0.86
  - 鸡皮：0.67
  - 米饭：待优化

## 注意事项
1. 录音建议：
   - 保持适当的麦克风距离
   - 避免环境噪声
   - 每个样本录制15-20秒
   
2. 音频格式：
   - 支持格式：wav, mp3, m4a
   - 自动转换为wav格式处理

## 未来改进方向

1. **数据增强**：
   - 添加噪声增强
   - 时间拉伸/压缩
   - 音高变化

2. **模型优化**：
   - 尝试深度学习模型
   - 集成学习方法
   - 超参数优化

3. **特征工程**：
   - 添加更多声学特征
   - 特征选择优化
   - 时频域分析增强

## 作者
[Chil1T]

## 许可证
MIT License 
